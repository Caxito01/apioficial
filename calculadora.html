<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BotConversa - Calculadora</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f5f5; }
    
    /* Header */
    .header { background: #2a9d8f; color: white; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; }
    .header h1 { font-size: 18px; font-weight: 500; }
    .header span { font-size: 13px; }
    
    /* Layout */
    .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
    
    /* Main Content */
    .main { width: 100%; }
    .breadcrumb { font-size: 13px; color: #666; margin-bottom: 15px; }
    .breadcrumb span { color: #5bc0de; }
    .page-title { font-size: 20px; color: #333; margin-bottom: 20px; font-weight: 400; }
    
    /* Cards */
    .card { background: white; border: 1px solid #ddd; margin-bottom: 20px; }
    .card-header { background: #5bc0de; color: white; padding: 10px 15px; font-size: 14px; font-weight: 500; }
    .card-body { padding: 20px; }
    
    /* Form Grid */
    .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
    .form-group { display: flex; flex-direction: column; }
    .form-group label { font-size: 12px; color: #666; margin-bottom: 5px; text-transform: uppercase; }
    .form-group input, .form-group select { padding: 8px 12px; border: 1px solid #ccc; border-radius: 3px; font-size: 14px; }
    .form-group input:focus { outline: none; border-color: #5bc0de; }
    .form-group input:disabled { background: #f0f0f0; color: #333; }
    .form-group input.highlight { background: #d4edda; border-color: #28a745; font-weight: bold; font-size: 16px; }
    
    /* Table Style */
    .table-container { overflow-x: auto; }
    table { width: 100%; border-collapse: collapse; font-size: 13px; }
    th { background: #f8f8f8; text-align: left; padding: 10px; border-bottom: 2px solid #ddd; color: #666; font-weight: 600; text-transform: uppercase; font-size: 11px; }
    td { padding: 10px; border-bottom: 1px solid #eee; }
    tr:hover { background: #f9f9f9; }
    
    .resultado-box { background: #d4edda; border: 2px solid #28a745; padding: 20px; border-radius: 5px; margin-top: 15px; text-align: center; }
    .resultado-box .total-label { font-size: 13px; color: #155724; font-weight: 600; text-transform: uppercase; }
    .resultado-box .total-value { font-size: 28px; color: #155724; font-weight: bold; margin-top: 10px; }
    
    /* Destaque para campos cr√≠ticos */
    .form-group input.destaque-excedentes {
      background-color: #fff3cd !important;
      border: 2px solid #ffc107 !important;
      color: #856404 !important;
      font-weight: 600;
    }
    
    .conta-texto { font-size: 13px; color: #155724; margin-top: 10px; font-style: italic; text-align: center; }
    .resultado-dias-final { font-size: 16px; color: #fff; background-color: #28a745; padding: 5px 12px; border-radius: 3px; font-weight: bold; display: inline-block; margin: 8px 0; }
    
    .conta-texto strong { color: #155724; }
    .conta-texto-data { display: block; margin-top: 8px; font-size: 14px; color: #155724; }
    .alert-consultor { background: #fff3cd; border: 1px solid #ffc107; padding: 10px; border-radius: 3px; color: #856404; margin-top: 10px; }
    
    /* Destaque din√¢mico da linha da tabela */
    tbody tr.destaque-nivel { background-color: #fffacd !important; }
    tbody tr.destaque-nivel:hover { background-color: #ffeb99 !important; }
  </style>
</head>
<body>
  <div class="header">
    <h1>BotConversa</h1>
    <span>BEM-VINDO, USU√ÅRIO</span>
  </div>
  
  <div class="container">
    <div class="main">
      <div class="breadcrumb">In√≠cio ‚Ä∫ <span>Calculadoras</span></div>
      <div class="page-title">CECM - CALCULADORA DE CONVERS√ÉO BOTCONVERSA</div>
      
      <!-- SE√á√ÉO 1: Calculadora de Dias -->
      <div class="card">
        <div class="card-header">üìÖ CALCULADORA DE CONVERS√ÉO PARA API OFICIAL</div>
        <div class="card-body">
          <div class="form-grid">
            <div class="form-group">
              <label>Data de VENCIMENTO</label>
              <input type="date" id="dataDestino">
            </div>
            <div class="form-group">
              <label>Dias Restantes</label>
              <input type="text" id="diasRestantes" disabled placeholder="0">
            </div>
            <div class="form-group">
              <label>Dias √∑ 3 (Arredondado)</label>
              <input type="text" id="diasDividido" disabled placeholder="0">
            </div>
          </div>
          
          <div class="resultado-box" id="resultadoBoxDias" style="display: none;">
            <div class="total-label">üìä TOTAL DE DIAS RESTANTES</div>
            <div class="total-value" id="diasTotal">0 dias</div>
            <div class="conta-texto" id="contaDias"></div>
          </div>
        </div>
      </div>
      
      <!-- SE√á√ÉO 2: Calculadora de Custos -->
      <div class="card">
        <div class="card-header">üí∞ CALCULADORA DE CUSTOS API OFICIAL BOTCONVERSA</div>
        <div class="card-body">
          <div class="form-grid">
            <div class="form-group">
              <label>Quantidade de Contatos</label>
              <input type="number" id="qtdContatos" min="1" placeholder="Digite a quantidade">
            </div>
            <div class="form-group">
              <label>N√≠vel do Plano</label>
              <input type="text" id="nivelPlano" disabled placeholder="-">
            </div>
            <div class="form-group">
              <label>Limite de Contatos</label>
              <input type="text" id="limiteContatos" disabled placeholder="-">
            </div>
            <div class="form-group">
              <label>Mensalidade</label>
              <input type="text" id="mensalidade" disabled placeholder="R$ 0,00">
            </div>
            <div class="form-group">
              <label>Contatos Excedentes</label>
              <input type="text" id="excedentes" disabled placeholder="0" class="destaque-excedentes">
            </div>
            <div class="form-group">
              <label>Custo por 100 Extras</label>
              <input type="text" id="custoPor100" disabled placeholder="R$ 0,00">
            </div>
            <div class="form-group">
              <label>Custo dos Excedentes</label>
              <input type="text" id="custoExcedentes" disabled placeholder="R$ 0,00" class="destaque-excedentes">
            </div>
          </div>
          
          <div class="resultado-box" id="resultadoBox" style="display: none;">
            <div class="total-label">üíµ CUSTO TOTAL MENSAL</div>
            <div class="total-value" id="custoTotal">R$ 0,00</div>
          </div>
          <div class="alert-consultor" id="alertConsultor" style="display:none;">
            ‚ö†Ô∏è Para mais de 10.000 contatos, entre em contato com um consultor.
          </div>
        </div>
      </div>
      
      <!-- Tabela de Refer√™ncia -->
      <div class="card">
        <div class="card-header">üìã TABELA DE PLANOS - REFER√äNCIA</div>
        <div class="card-body">
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Plano</th>
                  <th>Contatos/M√™s</th>
                  <th>Mensalidade</th>
                  <th>Custo por 100 (excedente)</th>
                </tr>
              </thead>
              <tbody>
                <tr id="linha-nivel-1"><td>N√≠vel 1</td><td>At√© 500</td><td>R$ 199,00</td><td>R$ 39,80</td></tr>
                <tr id="linha-nivel-2"><td>N√≠vel 2</td><td>1.000 - 2.499</td><td>R$ 299,00</td><td>R$ 23,90</td></tr>
                <tr id="linha-nivel-3"><td>N√≠vel 3</td><td>2.500 - 4.999</td><td>R$ 599,00</td><td>R$ 23,96</td></tr>
                <tr id="linha-nivel-4"><td>N√≠vel 4</td><td>5.000 - 7.999</td><td>R$ 999,00</td><td>R$ 19,98</td></tr>
                <tr id="linha-nivel-5"><td>N√≠vel 5</td><td>8.000 - 9.999</td><td>R$ 1.499,00</td><td>R$ 18,74</td></tr>
                <tr id="linha-nivel-6"><td>N√≠vel 6</td><td>10.000+</td><td>R$ 1.799,00</td><td>R$ 17,99</td></tr>
                <tr id="linha-nivel-7"><td>N√≠vel 7</td><td>Volume Alto</td><td>Consultor</td><td>Consultor</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const planos = [
      { nivel: 1, minimo: 0, maximo: 999, contatosInclusos: 500, mensalidade: 199, custoPor100: 39.80 },
      { nivel: 2, minimo: 1000, maximo: 2499, contatosInclusos: 1000, mensalidade: 299, custoPor100: 23.90 },
      { nivel: 3, minimo: 2500, maximo: 4999, contatosInclusos: 2500, mensalidade: 599, custoPor100: 23.96 },
      { nivel: 4, minimo: 5000, maximo: 7999, contatosInclusos: 5000, mensalidade: 999, custoPor100: 19.98 },
      { nivel: 5, minimo: 8000, maximo: 9999, contatosInclusos: 8000, mensalidade: 1499, custoPor100: 18.74 },
      { nivel: 6, minimo: 10000, maximo: 10000, contatosInclusos: 10000, mensalidade: 1799, custoPor100: 17.99 }
    ];

    function formatarMoeda(valor) {
      return valor.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
    }

    function calcularDias() {
      const input = document.getElementById('dataDestino').value;
      if (!input) {
        document.getElementById('diasRestantes').value = '';
        document.getElementById('diasDividido').value = '';
        document.getElementById('contaDias').innerHTML = '';
        document.getElementById('resultadoBoxDias').style.display = 'none';
        return;
      }

      const dataDestino = new Date(input + 'T00:00:00');
      const hoje = new Date();
      hoje.setHours(0, 0, 0, 0);
      
      const diffTime = dataDestino - hoje;
      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
      
      document.getElementById('diasRestantes').value = diffDays + ' dias';
      
      const dividido = diffDays / 3;
      const arredondado = Math.ceil(dividido);
      document.getElementById('diasDividido').value = arredondado + ' dias';
      
      // Calcula a data final baseado no arredondado (120 dias)
      const dataFinal = new Date();
      dataFinal.setDate(dataFinal.getDate() + arredondado);
      const diaFinal = String(dataFinal.getDate()).padStart(2, '0');
      const mesFinal = String(dataFinal.getMonth() + 1).padStart(2, '0');
      const anoFinal = dataFinal.getFullYear();
      const dataFinalFormatada = `${diaFinal}/${mesFinal}/${anoFinal}`;
      
      document.getElementById('contaDias').innerHTML = `<div style="text-align: center;">
        <div><strong>C√°lculo:</strong> ${diffDays} √∑ 3 = ${dividido.toFixed(2)}</div>
        <div class="resultado-dias-final">${arredondado} dias de Api Oficial</div>
        <div class="conta-texto-data"><strong>Data final:</strong> ${dataFinalFormatada}</div>
      </div>`;
      
      // Mostra o box destacado
      document.getElementById('diasTotal').textContent = diffDays + ' dias';
      document.getElementById('resultadoBoxDias').style.display = 'block';
    }

    function calcularCustos() {
      const qtd = parseInt(document.getElementById('qtdContatos').value) || 0;
      
      if (qtd <= 0) {
        document.getElementById('resultadoBox').style.display = 'none';
        // Limpa todos os campos
        document.getElementById('nivelPlano').value = '';
        document.getElementById('limiteContatos').value = '';
        document.getElementById('mensalidade').value = '';
        document.getElementById('excedentes').value = '';
        document.getElementById('custoPor100').value = '';
        document.getElementById('custoExcedentes').value = '';
        // Remove destaque anterior
        document.querySelectorAll('tbody tr').forEach(tr => {
          tr.classList.remove('destaque-nivel');
        });
        return;
      }

      if (qtd < 1 || qtd > 999) {
        // Se for menor que 1 ou maior que 999, aplicar l√≥gica normal
      } else {
        // Para 1-999, for√ßar N√≠vel 1
        const plano = planos[0]; // N√≠vel 1
        document.getElementById('alertConsultor').style.display = 'none';
        document.getElementById('nivelPlano').value = 'N√≠vel ' + plano.nivel;
        document.getElementById('limiteContatos').value = plano.contatosInclusos.toLocaleString('pt-BR');
        document.getElementById('mensalidade').value = formatarMoeda(plano.mensalidade);
        document.getElementById('custoPor100').value = formatarMoeda(plano.custoPor100);
        document.getElementById('linha-nivel-' + plano.nivel).classList.add('destaque-nivel');
        const excedentes = Math.max(0, qtd - plano.contatosInclusos);
        document.getElementById('excedentes').value = excedentes.toLocaleString('pt-BR');
        let custoExcedentesValor = 0;
        if (excedentes === 0) {
          document.getElementById('custoExcedentes').value = formatarMoeda(0);
        } else {
          const blocosExcedentes = Math.ceil(excedentes / 100);
          custoExcedentesValor = blocosExcedentes * plano.custoPor100;
          document.getElementById('custoExcedentes').value = `${blocosExcedentes} √ó ${formatarMoeda(plano.custoPor100)} = ${formatarMoeda(custoExcedentesValor)}`;
        }
        const total = plano.mensalidade + custoExcedentesValor;
        document.getElementById('custoTotal').textContent = formatarMoeda(total);
        document.getElementById('resultadoBox').style.display = 'block';
        return;
      }

      // Remove destaque anterior de todas as linhas
      document.querySelectorAll('tbody tr').forEach(tr => {
        tr.classList.remove('destaque-nivel');
      });

      // Encontra o plano que atende essa quantidade
      const plano = planos.find(p => qtd >= p.minimo && qtd <= p.maximo);
      
      if (!plano) {
        // Acima de 10.000 - consultor
        document.getElementById('nivelPlano').value = 'N√≠vel 7';
        document.getElementById('limiteContatos').value = '10.001+';
        document.getElementById('mensalidade').value = 'Fale com consultor';
        document.getElementById('excedentes').value = '-';
        document.getElementById('custoPor100').value = '-';
        document.getElementById('custoExcedentes').value = '-';
        document.getElementById('custoTotal').textContent = 'Fale com consultor';
        document.getElementById('alertConsultor').style.display = 'block';
        document.getElementById('resultadoBox').style.display = 'block';
        return;
      }

      document.getElementById('alertConsultor').style.display = 'none';
      document.getElementById('nivelPlano').value = 'N√≠vel ' + plano.nivel;
      document.getElementById('limiteContatos').value = plano.contatosInclusos.toLocaleString('pt-BR');
      document.getElementById('mensalidade').value = formatarMoeda(plano.mensalidade);
      document.getElementById('custoPor100').value = formatarMoeda(plano.custoPor100);

      // Destaca a linha da tabela do n√≠vel atual
      document.getElementById('linha-nivel-' + plano.nivel).classList.add('destaque-nivel');

      // Calcula excedentes em rela√ß√£o aos CONTATOS INCLUSOS do n√≠vel
      const excedentes = Math.max(0, qtd - plano.contatosInclusos);
      
      document.getElementById('excedentes').value = excedentes.toLocaleString('pt-BR');
      
      let custoExcedentesValor = 0;
      if (excedentes === 0) {
        // Sem excedentes, s√≥ paga a franquia
        document.getElementById('custoExcedentes').value = formatarMoeda(0);
      } else {
        // Com excedentes
        const blocosExcedentes = Math.ceil(excedentes / 100);
        custoExcedentesValor = blocosExcedentes * plano.custoPor100;
        document.getElementById('custoExcedentes').value = `${blocosExcedentes} √ó ${formatarMoeda(plano.custoPor100)} = ${formatarMoeda(custoExcedentesValor)}`;
      }
      
      // Calcula total: mensalidade + custo excedentes
      const total = plano.mensalidade + custoExcedentesValor;
      document.getElementById('custoTotal').textContent = formatarMoeda(total);
      document.getElementById('resultadoBox').style.display = 'block';
    }

    function limparCamposCusto() {
      ['nivelPlano','limiteContatos','mensalidade','excedentes','custoPor100','custoExcedentes'].forEach(id => {
        document.getElementById(id).value = '';
      });
      document.getElementById('resultadoBox').style.display = 'none';
      document.getElementById('alertConsultor').style.display = 'none';
    }

    // Inicializar eventos quando o DOM estiver pronto
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('dataDestino').addEventListener('change', calcularDias);
      document.getElementById('qtdContatos').addEventListener('input', calcularCustos);
    });
  </script>
</body>
</html>
